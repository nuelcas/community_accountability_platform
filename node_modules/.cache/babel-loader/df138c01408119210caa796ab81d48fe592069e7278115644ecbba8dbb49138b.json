{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Routes,Route}from\"react-router-dom\";import Home from\"./components/Home\";import BlogPage from\"./components/BlogPage\";import ReportIssue from\"./components/ReportIssue\";import RealTimeTracking from\"./components/RealTimeTracking\";import Login from\"./components/Login\";import Register from\"./components/Register\";import Polls from\"./components/Polls\";import Navbar from\"./components/Navbar\";import ProtectedRoute from\"./components/ProtectedRoute\";import{useAuth}from\"./context/AuthContext\";import axios from\"axios\";// Import axios for making the API request\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[protectedData,setProtectedData]=useState(null);const{user}=useAuth();// Get authentication state\n// Function to fetch the protected data when a user accesses a protected route\nconst fetchProtectedData=()=>{const token=localStorage.getItem(\"authToken\");// Fetch the token from local storage\nif(!token){console.error(\"No token found, please login.\");return;}axios.get(\"http://localhost:3000/api/protected\",{headers:{Authorization:`Bearer ${token}`// Attach the token to the request\n}}).then(response=>{console.log(response.data);setProtectedData(response.data);// Store the protected data in state\n}).catch(error=>console.error(\"Error fetching protected data:\",error));};useEffect(()=>{if(user){fetchProtectedData();// Fetch protected data once the user is logged in\n}},[user]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/blogpage\",element:/*#__PURE__*/_jsx(BlogPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsx(Route,{path:\"/reportissue\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(ReportIssue,{protectedData:protectedData})})}),/*#__PURE__*/_jsx(Route,{path:\"/realtimetracking\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(RealTimeTracking,{protectedData:protectedData})})}),/*#__PURE__*/_jsx(Route,{path:\"/polls\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(Polls,{protectedData:protectedData})})})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","Home","BlogPage","ReportIssue","RealTimeTracking","Login","Register","Polls","Navbar","ProtectedRoute","useAuth","axios","jsx","_jsx","jsxs","_jsxs","App","protectedData","setProtectedData","user","fetchProtectedData","token","localStorage","getItem","console","error","get","headers","Authorization","then","response","log","data","catch","children","exact","path","element"],"sources":["C:/cap/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Routes, Route } from \"react-router-dom\";\nimport Home from \"./components/Home\";\nimport BlogPage from \"./components/BlogPage\";\nimport ReportIssue from \"./components/ReportIssue\";\nimport RealTimeTracking from \"./components/RealTimeTracking\";\nimport Login from \"./components/Login\";\nimport Register from \"./components/Register\";\nimport Polls from \"./components/Polls\";\nimport Navbar from \"./components/Navbar\";\nimport ProtectedRoute from \"./components/ProtectedRoute\";\nimport { useAuth } from \"./context/AuthContext\";\nimport axios from \"axios\"; // Import axios for making the API request\n\nfunction App() {\n  const [protectedData, setProtectedData] = useState(null);\n  const { user } = useAuth(); // Get authentication state\n\n  // Function to fetch the protected data when a user accesses a protected route\n  const fetchProtectedData = () => {\n    const token = localStorage.getItem(\"authToken\"); // Fetch the token from local storage\n    if (!token) {\n      console.error(\"No token found, please login.\");\n      return;\n    }\n\n    axios\n      .get(\"http://localhost:3000/api/protected\", {\n        headers: {\n          Authorization: `Bearer ${token}`, // Attach the token to the request\n        },\n      })\n      .then((response) => {\n        console.log(response.data);\n        setProtectedData(response.data); // Store the protected data in state\n      })\n      .catch((error) => console.error(\"Error fetching protected data:\", error));\n  };\n\n  useEffect(() => {\n    if (user) {\n      fetchProtectedData(); // Fetch protected data once the user is logged in\n    }\n  }, [user]);\n\n  return (\n    <div>\n      <Navbar />\n      <Routes>\n        <Route exact path=\"/\" element={<Home />} />\n        <Route path=\"/blogpage\" element={<BlogPage />} />\n        <Route path=\"/login\" element={<Login />} />\n        <Route path=\"/register\" element={<Register />} />\n\n        {/* Protect routes by wrapping them with ProtectedRoute */}\n        <Route\n          path=\"/reportissue\"\n          element={\n            <ProtectedRoute>\n              <ReportIssue protectedData={protectedData} />\n            </ProtectedRoute>\n          }\n        />\n        <Route\n          path=\"/realtimetracking\"\n          element={\n            <ProtectedRoute>\n              <RealTimeTracking protectedData={protectedData} />\n            </ProtectedRoute>\n          }\n        />\n        <Route\n          path=\"/polls\"\n          element={\n            <ProtectedRoute>\n              <Polls protectedData={protectedData} />\n            </ProtectedRoute>\n          }\n        />\n      </Routes>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}